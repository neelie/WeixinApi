var WeixinApi=function(){"use strict";function e(e,t){t=t||{};var n=function(e){WeixinJSBridge.invoke("shareTimeline",{appid:e.appId?e.appId:"",img_url:e.imgUrl,link:e.link,desc:e.title,title:e.desc,img_width:"640",img_height:"640"},function(e){switch(e.err_msg){case"share_timeline:cancel":t.cancel&&t.cancel(e);break;case"share_timeline:confirm":case"share_timeline:ok":t.confirm&&t.confirm(e);break;case"share_timeline:fail":default:t.fail&&t.fail(e);break}t.all&&t.all(e)})};WeixinJSBridge.on("menu:share:timeline",function(r){if(t.async&&t.ready){window["_wx_loadedCb_"]=t.dataLoaded||new Function;if(window["_wx_loadedCb_"].toString().indexOf("_wx_loadedCb_")>0){window["_wx_loadedCb_"]=new Function}t.dataLoaded=function(e){window["_wx_loadedCb_"](e);n(e)};t.ready&&t.ready(r)}else{t.ready&&t.ready(r);n(e)}})}function t(e,t){t=t||{};var n=function(e){WeixinJSBridge.invoke("sendAppMessage",{appid:e.appId?e.appId:"",img_url:e.imgUrl,link:e.link,desc:e.desc,title:e.title,img_width:"640",img_height:"640"},function(e){switch(e.err_msg){case"send_app_msg:cancel":t.cancel&&t.cancel(e);break;case"send_app_msg:confirm":case"send_app_msg:ok":t.confirm&&t.confirm(e);break;case"send_app_msg:fail":default:t.fail&&t.fail(e);break}t.all&&t.all(e)})};WeixinJSBridge.on("menu:share:appmessage",function(r){if(t.async&&t.ready){window["_wx_loadedCb_"]=t.dataLoaded||new Function;if(window["_wx_loadedCb_"].toString().indexOf("_wx_loadedCb_")>0){window["_wx_loadedCb_"]=new Function}t.dataLoaded=function(e){window["_wx_loadedCb_"](e);n(e)};t.ready&&t.ready(r)}else{t.ready&&t.ready(r);n(e)}})}function n(e,t){t=t||{};var n=function(e){WeixinJSBridge.invoke("shareWeibo",{content:e.desc,url:e.link},function(e){switch(e.err_msg){case"share_weibo:cancel":t.cancel&&t.cancel(e);break;case"share_weibo:confirm":case"share_weibo:ok":t.confirm&&t.confirm(e);break;case"share_weibo:fail":default:t.fail&&t.fail(e);break}t.all&&t.all(e)})};WeixinJSBridge.on("menu:share:weibo",function(r){if(t.async&&t.ready){window["_wx_loadedCb_"]=t.dataLoaded||new Function;if(window["_wx_loadedCb_"].toString().indexOf("_wx_loadedCb_")>0){window["_wx_loadedCb_"]=new Function}t.dataLoaded=function(e){window["_wx_loadedCb_"](e);n(e)};t.ready&&t.ready(r)}else{t.ready&&t.ready(r);n(e)}})}function r(e,t){t=t||{};var n=function(e,n){if(e.shareTo=="timeline"){var r=n.title;n.title=n.desc||r;n.desc=r}e.generalShare({appid:n.appId?n.appId:"",img_url:n.imgUrl,link:n.link,desc:n.desc,title:n.title,img_width:"640",img_height:"640"},function(n){switch(n.err_msg){case"general_share:cancel":t.cancel&&t.cancel(n,e.shareTo);break;case"general_share:confirm":case"general_share:ok":t.confirm&&t.confirm(n,e.shareTo);break;case"general_share:fail":default:t.fail&&t.fail(n,e.shareTo);break}t.all&&t.all(n,e.shareTo)})};WeixinJSBridge.on("menu:general:share",function(r){if(t.async&&t.ready){window["_wx_loadedCb_"]=t.dataLoaded||new Function;if(window["_wx_loadedCb_"].toString().indexOf("_wx_loadedCb_")>0){window["_wx_loadedCb_"]=new Function}t.dataLoaded=function(e){window["_wx_loadedCb_"](e);n(r,e)};t.ready&&t.ready(r,r.shareTo)}else{t.ready&&t.ready(r,r.shareTo);n(r,e)}})}function i(e,t){t=t||{};WeixinJSBridge.invoke("addContact",{webtype:"1",username:e},function(e){var n=!e.err_msg||"add_contact:ok"==e.err_msg||"add_contact:added"==e.err_msg;if(n){t.success&&t.success(e)}else{t.fail&&t.fail(e)}})}function s(e,t){if(!e||!t||t.length==0){return}WeixinJSBridge.invoke("imagePreview",{current:e,urls:t})}function o(){WeixinJSBridge.call("showOptionMenu")}function u(){WeixinJSBridge.call("hideOptionMenu")}function a(){WeixinJSBridge.call("showToolbar")}function f(){WeixinJSBridge.call("hideToolbar")}function l(e){if(e&&typeof e=="function"){WeixinJSBridge.invoke("getNetworkType",{},function(t){e(t.err_msg)})}}function c(){WeixinJSBridge.call("closeWindow")}function h(e){if(e&&typeof e=="function"){var t=this;var n=function(){e(t)};if(typeof window.WeixinJSBridge=="undefined"){if(document.addEventListener){document.addEventListener("WeixinJSBridgeReady",n,false)}else if(document.attachEvent){document.attachEvent("WeixinJSBridgeReady",n);document.attachEvent("onWeixinJSBridgeReady",n)}}else{n()}}}function p(){return/MicroMessenger/i.test(navigator.userAgent)}function d(){WeixinJSBridge.invoke("scanQRCode")}return{version:"2.1",ready:h,shareToTimeline:e,shareToWeibo:n,shareToFriend:t,generalShare:r,addContact:i,showOptionMenu:o,hideOptionMenu:u,showToolbar:a,hideToolbar:f,getNetworkType:l,imagePreview:s,closeWindow:c,openInWeixin:p,scanQRCode:d}}()